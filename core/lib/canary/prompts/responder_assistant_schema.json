{
  "type": "object",
  "title": "AskResponse",
  "properties": {
    "scratchpad": {
      "type": "string",
      "description": "A space for planning how to respond. Must come before the blocks."
    },
    "blocks": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["text", "reference"]
          }
        },
        "required": ["type"],
        "oneOf": [
          {
            "title": "AskResponseTextBlock",
            "description": "A block containing markdown-formatted text. MUST followed by one or several reference blocks. At least one text block is required since you should answer the user's question anyway.",
            "properties": {
              "type": {
                "const": "text"
              },
              "text": {
                "type": "string",
                "description": "Markdown-formatted text."
              }
            },
            "required": ["type", "text"],
            "additionalProperties": false
          },
          {
            "title": "AskResponseReferenceBlock",
            "description": "A block containing a reference to a source.",
            "properties": {
              "type": {
                "const": "reference"
              },
              "title": {
                "type": "string",
                "description": "Title copied from the document."
              },
              "url": {
                "type": "string",
                "description": "URL copied from the document."
              },
              "sections": {
                "type": "array",
                "description": "An array of relevant sections inside a single document.",
                "items": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "description": "Title copied from the document. Can be omitted or empty."
                    },
                    "url": {
                      "type": "string",
                      "description": "URL copied from the document. Can be omitted or empty."
                    },
                    "excerpt": {
                      "type": "string",
                      "description": "A relevant excerpt from the section. Since scraped source can be messy, it is encouraged to fix formatting or remove odd words as you transcribe, but you should not change the content."
                    },
                    "explanation": {
                      "type": "string",
                      "description": "An explanation of how the excerpt relates to the query. Should be concise and strictly fact-based."
                    }
                  },
                  "required": ["excerpt", "explanation"],
                  "additionalProperties": false
                }
              }
            },
            "required": ["type", "title", "url", "sections"],
            "additionalProperties": false
          }
        ]
      }
    }
  },
  "required": ["blocks"],
  "additionalProperties": false
}
